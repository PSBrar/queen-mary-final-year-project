{% extends './base.html' %}
{% block content %}

{% load crispy_forms_tags %}


<div id = "App">
{{ idData|json_script:"idData" }}
<script>
  const postID = JSON.parse(document.getElementById('idData').textContent)
</script>

    <h1>Offers</h1>
    <!--<p id = "postID"> data for fucks sake </p>-->
    <!--{% for offer in postOffers %}
    {% if post.isDeclined == false %}-->
    <div v-for="(offer, index) in offersObject">
    <div class="card" style="width: 18rem;">
      <div class="card-body">
        <h5 class="card-title">From</h5>
        <p class="card-text">Â£[[offer.price]]</p>
        <p class="card-text">[[offer.comments]]</p>
        <a href="#" id="pleasework" class="btn btn-success">Accept</a>
        <a href="#" class="btn btn-warning">Placeholder</a>
        <!--<a href="{% url 'conversation' offer.id%}" class="btn btn-primary">Message</a>-->
        <a href = "offer.msgURL" class="btn btn-primary">Message</a>
        <a href="#" class="btn btn-danger">Decline</a>
    
      </div>
      </div>
    </div>
    <!--
    {% endif %}
    {% endfor %}
  -->
</div>

<script>
  let myApp = Vue.createApp({
      delimiters: ["[[", "]]"],
      data() {
          return {
              offersObject: [],
          }
      },
      async created(){
        //console.log(mydata)

        apiCall = `/api/get_offers_api/${postID.post_id}`
        let response = await fetch(apiCall, {method:"GET",});
        //id = postID.post_id
        
            if (response.ok) {
                let data = await response.json();
                this.offersObject = data.offers;
            }
            else{
              alert("something went wrong")
            }
          
        console.log(this.offersObject)

      },
      async mounted(){
        //console.log(this.offersObject)
        

        //console.log(postID.post_id)
        
        //var postID = document.querySelector("#postID").textContent
        //var postID = document.getElementById('pleasework');
        //var postID = (document.querySelector("#postID").textContent);
        //var postID = ("{{idData}}")
        //console.log(postID)
        /*this.postID = postID;*/
        
          
      },
      methods:{
        
      },
    })
  myApp.mount("#App")
</script>



{% endblock %}